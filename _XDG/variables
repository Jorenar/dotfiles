# XDG #
# vim: ft=sh fdm=marker fen

# Parse 'pam_environment' (when executing install.sh) {{{1
if [ -n "$DIR" ]; then
    eval "$(cat "$DIR/pam_environment" | sed -r 's/\s*DEFAULT//g' | sed -r 's/\@\{/\$\{/' | sed -r 's/^([A-Z]i)/export\ \1/g')"
fi

# CUSTOM {{{1
export _XDG_WRAPPERS="$XDG_LOCAL_HOME/bin/_xdg_wrappers"
export XDG_FAKEHOME_DIR="$XDG_LOCAL_HOME/home"
export XDG_GAMES_DIR="$XDG_LOCAL_HOME/games"
export XDG_HISTORY_DIR="$XDG_CACHE_HOME/history"
export XDG_VM_DIR="$XDG_LOCAL_HOME/vm"

# PATH {{{2
export PATH="$XDG_LOCAL_HOME/AppImages:$PATH"
export PATH="$XDG_LOCAL_HOME/bin:$PATH"
export PATH="$XDG_LOCAL_HOME/scripts:$PATH"

export PATH="$_XDG_WRAPPERS:$PATH"

# PROGRAMS' dots RELOCATING VARIABLES {{{1
export _JAVA_OPTIONS=-Djava.util.prefs.userRoot="$XDG_CONFIG_HOME/java"
export BASH_COMPLETION_USER_FILE="$XDG_CONFIG_HOME/bash/bash_completion"
export DCONF_PROFILE="$XDG_CONFIG_HOME/dconf/user"
export ELECTRUMDIR="$XDG_DATA_HOME/electrum"
export ELINKS_CONFDIR="$XDG_CONFIG_HOME/elinks"
export ENV="$XDG_CONFIG_HOME/shell/shrc"  # sh, ksh
export GIT_TEMPLATE_DIR="$XDG_CONFIG_HOME/git/template"
export GNUPGHOME="$XDG_DATA_HOME/gnupg"
export GOPATH="$XDG_DATA_HOME/go"
export GOPS_CONFIG_DIR="$XDG_CONFIG_HOME/gops" # temporary
export GRIPHOME="$XDG_CONFIG_HOME/grip"
export GTK2_RC_FILES="$XDG_CONFIG_HOME/gtk-2.0/gtkrc"
export ICEAUTHORITY="$XDG_CACHE_HOME/ICEauthority"
export IMAPFILTER_HOME="$XDG_CONFIG_HOME/imapfilter"
export INPUTRC="$XDG_CONFIG_HOME/readline/inputrc"
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/npmrc"
export PASSWORD_STORE_DIR="$XDG_DATA_HOME/pass"
export PYTHONSTARTUP="$XDG_CONFIG_HOME/python/config.py"
export PYTHONUSERBASE="$XDG_LOCAL_HOME"
export RANDFILE="$XDG_CACHE_HOME/rnd"
export VIMDOTDIR="$XDG_CONFIG_HOME/vim"
export VIMINIT='set rtp^=$VIMDOTDIR | let $MYVIMRC="$VIMDOTDIR/vimrc" | so $MYVIMRC'
export WEECHAT_HOME="$XDG_CONFIG_HOME/weechat"
export WINEPREFIX="$XDG_DATA_HOME/wine"
export XAUTHORITY="$XDG_RUNTIME_DIR/Xauthority"
export XINITRC="$XDG_CONFIG_HOME/X11/xinitrc"
export XSERVERRC="$XDG_CONFIG_HOME/X11/xserverrc"

# HISTORY FILES {{{1

mkdir -p "$XDG_HISTORY_DIR"

export HISTFILE="$XDG_HISTORY_DIR/shell"
export LESSHISTFILE=-
export MYSQL_HISTFILE="$XDG_HISTORY_DIR/mysql"
export NODE_REPL_HISTORY="$XDG_HISTORY_HOME/node_repl_history"
export SQLITE_HISTORY="$XDG_HISTORY_DIR/sqlite"

# Parse user-dirs.dirs {{{1

while IFS= read -r dir; do
    var="$(echo $dir | cut -f1 -d'#')"
    [ -n "$var" ] && eval export $var
done < "$XDG_CONFIG_HOME/user-dirs.dirs"
